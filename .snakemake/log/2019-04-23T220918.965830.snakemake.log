Building DAG of jobs...
Using shell: /anaconda2/envs/py3/bin/bash
Provided cores: 1
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	all
	4	color_genotypes_and_find_egg_mutations
	4	compair_pairs
	4	egg_epistasis
	4	export
	4	organize_output
	2	plot_background
	4	plot_background_kkclades
	4	plot_titer_diffs
	4	simplify_auspice_names
	4	tip_frequencies
	39

[Tue Apr 23 22:09:21 2019]
rule export:
    input: results/tree_who_h3n2_ha_12y_concat_fra.nwk, results/metadata_h3n2_ha.tsv, config/auspice_config_h3n2.json, results/branch-lengths_who_h3n2_ha_12y_concat_fra.json, results/nt-muts_who_h3n2_ha_12y_concat_fra.json, results/aa-muts_who_h3n2_ha_12y_concat_fra.json, results/titers-tree-model_who_h3n2_ha_12y_concat_fra.json, results/titers-sub-model_who_h3n2_ha_12y_concat_fra.json, results/clades_who_h3n2_ha_12y_concat_fra.json, results/traits_who_h3n2_ha_12y_concat_fra.json, results/lbi_who_h3n2_ha_12y_concat_fra.json, results/distances_who_h3n2_ha_12y_concat_fra.json
    output: auspice/flu_who_h3n2_ha_12y_concat_fra_tree.json, auspice/flu_who_h3n2_ha_12y_concat_fra_meta.json, auspice/flu_who_h3n2_ha_12y_concat_fra_root-sequence.json
    jobid: 40
    wildcards: center=who, lineage=h3n2, segment=ha, resolution=12y, passage=concat, assay=fra

[Tue Apr 23 22:09:43 2019]
Finished job 40.
1 of 39 steps (3%) done

[Tue Apr 23 22:09:43 2019]
rule export:
    input: results/tree_who_h3n2_ha_12y_concat_hi.nwk, results/metadata_h3n2_ha.tsv, config/auspice_config_h3n2.json, results/branch-lengths_who_h3n2_ha_12y_concat_hi.json, results/nt-muts_who_h3n2_ha_12y_concat_hi.json, results/aa-muts_who_h3n2_ha_12y_concat_hi.json, results/titers-tree-model_who_h3n2_ha_12y_concat_hi.json, results/titers-sub-model_who_h3n2_ha_12y_concat_hi.json, results/clades_who_h3n2_ha_12y_concat_hi.json, results/traits_who_h3n2_ha_12y_concat_hi.json, results/lbi_who_h3n2_ha_12y_concat_hi.json, results/distances_who_h3n2_ha_12y_concat_hi.json
    output: auspice/flu_who_h3n2_ha_12y_concat_hi_tree.json, auspice/flu_who_h3n2_ha_12y_concat_hi_meta.json, auspice/flu_who_h3n2_ha_12y_concat_hi_root-sequence.json
    jobid: 37
    wildcards: center=who, lineage=h3n2, segment=ha, resolution=12y, passage=concat, assay=hi

[Tue Apr 23 22:10:12 2019]
Finished job 37.
2 of 39 steps (5%) done

[Tue Apr 23 22:10:12 2019]
rule export:
    input: results/tree_who_h3n2_ha_6y_concat_hi.nwk, results/metadata_h3n2_ha.tsv, config/auspice_config_h3n2.json, results/branch-lengths_who_h3n2_ha_6y_concat_hi.json, results/nt-muts_who_h3n2_ha_6y_concat_hi.json, results/aa-muts_who_h3n2_ha_6y_concat_hi.json, results/titers-tree-model_who_h3n2_ha_6y_concat_hi.json, results/titers-sub-model_who_h3n2_ha_6y_concat_hi.json, results/clades_who_h3n2_ha_6y_concat_hi.json, results/traits_who_h3n2_ha_6y_concat_hi.json, results/lbi_who_h3n2_ha_6y_concat_hi.json, results/distances_who_h3n2_ha_6y_concat_hi.json
    output: auspice/flu_who_h3n2_ha_6y_concat_hi_tree.json, auspice/flu_who_h3n2_ha_6y_concat_hi_meta.json, auspice/flu_who_h3n2_ha_6y_concat_hi_root-sequence.json
    jobid: 31
    wildcards: center=who, lineage=h3n2, segment=ha, resolution=6y, passage=concat, assay=hi

[Tue Apr 23 22:10:33 2019]
Finished job 31.
3 of 39 steps (8%) done

[Tue Apr 23 22:10:33 2019]
rule export:
    input: results/tree_who_h3n2_ha_6y_concat_fra.nwk, results/metadata_h3n2_ha.tsv, config/auspice_config_h3n2.json, results/branch-lengths_who_h3n2_ha_6y_concat_fra.json, results/nt-muts_who_h3n2_ha_6y_concat_fra.json, results/aa-muts_who_h3n2_ha_6y_concat_fra.json, results/titers-tree-model_who_h3n2_ha_6y_concat_fra.json, results/titers-sub-model_who_h3n2_ha_6y_concat_fra.json, results/clades_who_h3n2_ha_6y_concat_fra.json, results/traits_who_h3n2_ha_6y_concat_fra.json, results/lbi_who_h3n2_ha_6y_concat_fra.json, results/distances_who_h3n2_ha_6y_concat_fra.json
    output: auspice/flu_who_h3n2_ha_6y_concat_fra_tree.json, auspice/flu_who_h3n2_ha_6y_concat_fra_meta.json, auspice/flu_who_h3n2_ha_6y_concat_fra_root-sequence.json
    jobid: 34
    wildcards: center=who, lineage=h3n2, segment=ha, resolution=6y, passage=concat, assay=fra

[Tue Apr 23 22:10:57 2019]
Finished job 34.
4 of 39 steps (10%) done

[Tue Apr 23 22:10:57 2019]
rule tip_frequencies:
    input: results/tree_who_h3n2_ha_12y_concat_fra.nwk, results/metadata_h3n2_ha.tsv, config/frequency_weights_by_region.json
    output: auspice/flu_who_h3n2_ha_12y_concat_fra_tip-frequencies.json
    jobid: 42
    wildcards: center=who, lineage=h3n2, segment=ha, resolution=12y, passage=concat, assay=fra

[Tue Apr 23 22:11:13 2019]
Finished job 42.
5 of 39 steps (13%) done

[Tue Apr 23 22:11:13 2019]
rule simplify_auspice_names:
    input: auspice/flu_who_h3n2_ha_12y_concat_fra_tree.json, results/tree_who_h3n2_ha_12y_concat_fra.nwk, auspice/flu_who_h3n2_ha_12y_concat_fra_meta.json, auspice/flu_who_h3n2_ha_12y_concat_fra_root-sequence.json, auspice/flu_who_h3n2_ha_12y_concat_fra_tip-frequencies.json
    output: auspice/flu_seasonal_h3n2_ha_12y_fra_tree.json, results/kk_clades_h3n2_ha_12y_fra.csv, auspice/flu_seasonal_h3n2_ha_12y_fra_meta.json, auspice/flu_seasonal_h3n2_ha_12y_fra_root-sequence.json, auspice/flu_seasonal_h3n2_ha_12y_fra_tip-frequencies.json
    jobid: 4
    wildcards: lineage=h3n2, segment=ha, resolution=12y, assay=fra

Waiting at most 5 seconds for missing files.
[Tue Apr 23 22:11:42 2019]
Finished job 4.
6 of 39 steps (15%) done

[Tue Apr 23 22:11:42 2019]
rule organize_output:
    input: auspice/flu_seasonal_h3n2_ha_12y_fra_tree.json, results/aa-seq_who_h3n2_ha_12y_concat_fra_HA1.fasta, auspice/flu_seasonal_h3n2_ha_12y_fra_root-sequence.json
    output: dataframes/h3n2_ha_12y_fra.csv, dataframes/h3n2_ha_12y_fra_egg.csv, dataframes/h3n2_ha_12y_fra_tidy.csv
    jobid: 8
    wildcards: lineage=h3n2, segment=ha, resolution=12y, assay=fra

[Tue Apr 23 22:13:03 2019]
Finished job 8.
7 of 39 steps (18%) done

[Tue Apr 23 22:13:03 2019]
rule color_genotypes_and_find_egg_mutations:
    input: auspice/flu_seasonal_h3n2_ha_12y_fra_tree.json, results/aa-seq_who_h3n2_ha_12y_concat_fra_HA1.fasta, auspice/flu_seasonal_h3n2_ha_12y_fra_meta.json, results/tree_who_h3n2_ha_12y_concat_fra.nwk, config/auspice_config_h3n2.json, dataframes/h3n2_ha_12y_fra.csv
    output: plots/h3n2_ha_12y_fra/egg_mutation_aa_prevalence_h3n2_ha_12y_fra.pdf, plots/h3n2_ha_12y_fra/egg_mutation_site_prevalence_h3n2_ha_12y_fra.pdf, plots/h3n2_ha_12y_fra/before_after_eggpassaging_h3n2_ha_12y_fra.pdf
    jobid: 12
    wildcards: lineage=h3n2, segment=ha, resolution=12y, assay=fra

[Tue Apr 23 22:13:23 2019]
Finished job 12.
8 of 39 steps (21%) done

[Tue Apr 23 22:13:23 2019]
rule tip_frequencies:
    input: results/tree_who_h3n2_ha_12y_concat_hi.nwk, results/metadata_h3n2_ha.tsv, config/frequency_weights_by_region.json
    output: auspice/flu_who_h3n2_ha_12y_concat_hi_tip-frequencies.json
    jobid: 39
    wildcards: center=who, lineage=h3n2, segment=ha, resolution=12y, passage=concat, assay=hi

[Tue Apr 23 22:13:38 2019]
Finished job 39.
9 of 39 steps (23%) done

[Tue Apr 23 22:13:38 2019]
rule simplify_auspice_names:
    input: auspice/flu_who_h3n2_ha_12y_concat_hi_tree.json, results/tree_who_h3n2_ha_12y_concat_hi.nwk, auspice/flu_who_h3n2_ha_12y_concat_hi_meta.json, auspice/flu_who_h3n2_ha_12y_concat_hi_root-sequence.json, auspice/flu_who_h3n2_ha_12y_concat_hi_tip-frequencies.json
    output: auspice/flu_seasonal_h3n2_ha_12y_hi_tree.json, results/kk_clades_h3n2_ha_12y_hi.csv, auspice/flu_seasonal_h3n2_ha_12y_hi_meta.json, auspice/flu_seasonal_h3n2_ha_12y_hi_root-sequence.json, auspice/flu_seasonal_h3n2_ha_12y_hi_tip-frequencies.json
    jobid: 3
    wildcards: lineage=h3n2, segment=ha, resolution=12y, assay=hi

Waiting at most 5 seconds for missing files.
[Tue Apr 23 22:14:09 2019]
Finished job 3.
10 of 39 steps (26%) done

[Tue Apr 23 22:14:09 2019]
rule organize_output:
    input: auspice/flu_seasonal_h3n2_ha_12y_hi_tree.json, results/aa-seq_who_h3n2_ha_12y_concat_hi_HA1.fasta, auspice/flu_seasonal_h3n2_ha_12y_hi_root-sequence.json
    output: dataframes/h3n2_ha_12y_hi.csv, dataframes/h3n2_ha_12y_hi_egg.csv, dataframes/h3n2_ha_12y_hi_tidy.csv
    jobid: 7
    wildcards: lineage=h3n2, segment=ha, resolution=12y, assay=hi

[Tue Apr 23 22:15:39 2019]
Finished job 7.
11 of 39 steps (28%) done

[Tue Apr 23 22:15:39 2019]
rule color_genotypes_and_find_egg_mutations:
    input: auspice/flu_seasonal_h3n2_ha_12y_hi_tree.json, results/aa-seq_who_h3n2_ha_12y_concat_hi_HA1.fasta, auspice/flu_seasonal_h3n2_ha_12y_hi_meta.json, results/tree_who_h3n2_ha_12y_concat_hi.nwk, config/auspice_config_h3n2.json, dataframes/h3n2_ha_12y_hi.csv
    output: plots/h3n2_ha_12y_hi/egg_mutation_aa_prevalence_h3n2_ha_12y_hi.pdf, plots/h3n2_ha_12y_hi/egg_mutation_site_prevalence_h3n2_ha_12y_hi.pdf, plots/h3n2_ha_12y_hi/before_after_eggpassaging_h3n2_ha_12y_hi.pdf
    jobid: 11
    wildcards: lineage=h3n2, segment=ha, resolution=12y, assay=hi

[Tue Apr 23 22:16:00 2019]
Finished job 11.
12 of 39 steps (31%) done

[Tue Apr 23 22:16:00 2019]
rule tip_frequencies:
    input: results/tree_who_h3n2_ha_6y_concat_fra.nwk, results/metadata_h3n2_ha.tsv, config/frequency_weights_by_region.json
    output: auspice/flu_who_h3n2_ha_6y_concat_fra_tip-frequencies.json
    jobid: 36
    wildcards: center=who, lineage=h3n2, segment=ha, resolution=6y, passage=concat, assay=fra

[Tue Apr 23 22:16:15 2019]
Finished job 36.
13 of 39 steps (33%) done

[Tue Apr 23 22:16:15 2019]
rule simplify_auspice_names:
    input: auspice/flu_who_h3n2_ha_6y_concat_fra_tree.json, results/tree_who_h3n2_ha_6y_concat_fra.nwk, auspice/flu_who_h3n2_ha_6y_concat_fra_meta.json, auspice/flu_who_h3n2_ha_6y_concat_fra_root-sequence.json, auspice/flu_who_h3n2_ha_6y_concat_fra_tip-frequencies.json
    output: auspice/flu_seasonal_h3n2_ha_6y_fra_tree.json, results/kk_clades_h3n2_ha_6y_fra.csv, auspice/flu_seasonal_h3n2_ha_6y_fra_meta.json, auspice/flu_seasonal_h3n2_ha_6y_fra_root-sequence.json, auspice/flu_seasonal_h3n2_ha_6y_fra_tip-frequencies.json
    jobid: 2
    wildcards: lineage=h3n2, segment=ha, resolution=6y, assay=fra

Waiting at most 5 seconds for missing files.
[Tue Apr 23 22:16:38 2019]
Finished job 2.
14 of 39 steps (36%) done

[Tue Apr 23 22:16:38 2019]
rule organize_output:
    input: auspice/flu_seasonal_h3n2_ha_6y_fra_tree.json, results/aa-seq_who_h3n2_ha_6y_concat_fra_HA1.fasta, auspice/flu_seasonal_h3n2_ha_6y_fra_root-sequence.json
    output: dataframes/h3n2_ha_6y_fra.csv, dataframes/h3n2_ha_6y_fra_egg.csv, dataframes/h3n2_ha_6y_fra_tidy.csv
    jobid: 6
    wildcards: lineage=h3n2, segment=ha, resolution=6y, assay=fra

[Tue Apr 23 22:17:48 2019]
Finished job 6.
15 of 39 steps (38%) done

[Tue Apr 23 22:17:48 2019]
rule color_genotypes_and_find_egg_mutations:
    input: auspice/flu_seasonal_h3n2_ha_6y_fra_tree.json, results/aa-seq_who_h3n2_ha_6y_concat_fra_HA1.fasta, auspice/flu_seasonal_h3n2_ha_6y_fra_meta.json, results/tree_who_h3n2_ha_6y_concat_fra.nwk, config/auspice_config_h3n2.json, dataframes/h3n2_ha_6y_fra.csv
    output: plots/h3n2_ha_6y_fra/egg_mutation_aa_prevalence_h3n2_ha_6y_fra.pdf, plots/h3n2_ha_6y_fra/egg_mutation_site_prevalence_h3n2_ha_6y_fra.pdf, plots/h3n2_ha_6y_fra/before_after_eggpassaging_h3n2_ha_6y_fra.pdf
    jobid: 10
    wildcards: lineage=h3n2, segment=ha, resolution=6y, assay=fra

[Tue Apr 23 22:18:04 2019]
Finished job 10.
16 of 39 steps (41%) done

[Tue Apr 23 22:18:04 2019]
rule tip_frequencies:
    input: results/tree_who_h3n2_ha_6y_concat_hi.nwk, results/metadata_h3n2_ha.tsv, config/frequency_weights_by_region.json
    output: auspice/flu_who_h3n2_ha_6y_concat_hi_tip-frequencies.json
    jobid: 33
    wildcards: center=who, lineage=h3n2, segment=ha, resolution=6y, passage=concat, assay=hi

[Tue Apr 23 22:18:22 2019]
Finished job 33.
17 of 39 steps (44%) done

[Tue Apr 23 22:18:22 2019]
rule simplify_auspice_names:
    input: auspice/flu_who_h3n2_ha_6y_concat_hi_tree.json, results/tree_who_h3n2_ha_6y_concat_hi.nwk, auspice/flu_who_h3n2_ha_6y_concat_hi_meta.json, auspice/flu_who_h3n2_ha_6y_concat_hi_root-sequence.json, auspice/flu_who_h3n2_ha_6y_concat_hi_tip-frequencies.json
    output: auspice/flu_seasonal_h3n2_ha_6y_hi_tree.json, results/kk_clades_h3n2_ha_6y_hi.csv, auspice/flu_seasonal_h3n2_ha_6y_hi_meta.json, auspice/flu_seasonal_h3n2_ha_6y_hi_root-sequence.json, auspice/flu_seasonal_h3n2_ha_6y_hi_tip-frequencies.json
    jobid: 1
    wildcards: lineage=h3n2, segment=ha, resolution=6y, assay=hi

Waiting at most 5 seconds for missing files.
[Tue Apr 23 22:18:44 2019]
Finished job 1.
18 of 39 steps (46%) done

[Tue Apr 23 22:18:44 2019]
rule organize_output:
    input: auspice/flu_seasonal_h3n2_ha_6y_hi_tree.json, results/aa-seq_who_h3n2_ha_6y_concat_hi_HA1.fasta, auspice/flu_seasonal_h3n2_ha_6y_hi_root-sequence.json
    output: dataframes/h3n2_ha_6y_hi.csv, dataframes/h3n2_ha_6y_hi_egg.csv, dataframes/h3n2_ha_6y_hi_tidy.csv
    jobid: 5
    wildcards: lineage=h3n2, segment=ha, resolution=6y, assay=hi

[Tue Apr 23 22:19:20 2019]
Finished job 5.
19 of 39 steps (49%) done

[Tue Apr 23 22:19:20 2019]
rule color_genotypes_and_find_egg_mutations:
    input: auspice/flu_seasonal_h3n2_ha_6y_hi_tree.json, results/aa-seq_who_h3n2_ha_6y_concat_hi_HA1.fasta, auspice/flu_seasonal_h3n2_ha_6y_hi_meta.json, results/tree_who_h3n2_ha_6y_concat_hi.nwk, config/auspice_config_h3n2.json, dataframes/h3n2_ha_6y_hi.csv
    output: plots/h3n2_ha_6y_hi/egg_mutation_aa_prevalence_h3n2_ha_6y_hi.pdf, plots/h3n2_ha_6y_hi/egg_mutation_site_prevalence_h3n2_ha_6y_hi.pdf, plots/h3n2_ha_6y_hi/before_after_eggpassaging_h3n2_ha_6y_hi.pdf
    jobid: 9
    wildcards: lineage=h3n2, segment=ha, resolution=6y, assay=hi

[Tue Apr 23 22:19:36 2019]
Finished job 9.
20 of 39 steps (51%) done

[Tue Apr 23 22:19:36 2019]
rule compair_pairs:
    input: dataframes/h3n2_ha_12y_fra.csv, results/aa-seq_who_h3n2_ha_12y_concat_fra_HA1.fasta
    output: plots/egg_results/egg_mutation_accuracy_h3n2_ha_12y_fra.json
    jobid: 26
    wildcards: lineage=h3n2, segment=ha, resolution=12y, assay=fra

[Tue Apr 23 22:21:29 2019]
Finished job 26.
21 of 39 steps (54%) done

[Tue Apr 23 22:21:29 2019]
rule compair_pairs:
    input: dataframes/h3n2_ha_12y_hi.csv, results/aa-seq_who_h3n2_ha_12y_concat_hi_HA1.fasta
    output: plots/egg_results/egg_mutation_accuracy_h3n2_ha_12y_hi.json
    jobid: 25
    wildcards: lineage=h3n2, segment=ha, resolution=12y, assay=hi

[Tue Apr 23 22:23:09 2019]
Finished job 25.
22 of 39 steps (56%) done

[Tue Apr 23 22:23:09 2019]
rule compair_pairs:
    input: dataframes/h3n2_ha_6y_fra.csv, results/aa-seq_who_h3n2_ha_6y_concat_fra_HA1.fasta
    output: plots/egg_results/egg_mutation_accuracy_h3n2_ha_6y_fra.json
    jobid: 24
    wildcards: lineage=h3n2, segment=ha, resolution=6y, assay=fra

[Tue Apr 23 22:24:32 2019]
Finished job 24.
23 of 39 steps (59%) done

[Tue Apr 23 22:24:32 2019]
rule compair_pairs:
    input: dataframes/h3n2_ha_6y_hi.csv, results/aa-seq_who_h3n2_ha_6y_concat_hi_HA1.fasta
    output: plots/egg_results/egg_mutation_accuracy_h3n2_ha_6y_hi.json
    jobid: 23
    wildcards: lineage=h3n2, segment=ha, resolution=6y, assay=hi

[Tue Apr 23 22:25:52 2019]
Finished job 23.
24 of 39 steps (62%) done

[Tue Apr 23 22:25:52 2019]
rule plot_background_kkclades:
    input: dataframes/h3n2_ha_12y_fra.csv, config/clades_h3n2_ha.tsv
    output: plots/h3n2_ha_12y_fra/genetic_background_kkclade_heatmap_h3n2_ha_12y_fra.pdf
    jobid: 22
    wildcards: lineage=h3n2, segment=ha, resolution=12y, assay=fra

[Tue Apr 23 22:25:58 2019]
Finished job 22.
25 of 39 steps (64%) done

[Tue Apr 23 22:25:58 2019]
rule egg_epistasis:
    input: dataframes/h3n2_ha_12y_fra.csv
    output: plots/h3n2_ha_12y_fra/epistasis_heatmap_h3n2_ha_12y_fra.pdf, plots/h3n2_ha_12y_fra/epistasis_chord_diagram_h3n2_ha_12y_fra.pdf
    jobid: 16
    wildcards: lineage=h3n2, segment=ha, resolution=12y, assay=fra

[Tue Apr 23 22:26:21 2019]
Finished job 16.
26 of 39 steps (67%) done

[Tue Apr 23 22:26:21 2019]
rule plot_titer_diffs:
    input: dataframes/h3n2_ha_12y_fra.csv
    output: plots/h3n2_ha_12y_fra/titer_diffs_h3n2_ha_12y_fra.pdf
    jobid: 30
    wildcards: lineage=h3n2, segment=ha, resolution=12y, assay=fra

[Tue Apr 23 22:26:25 2019]
Error in rule plot_titer_diffs:
    jobid: 30
    output: plots/h3n2_ha_12y_fra/titer_diffs_h3n2_ha_12y_fra.pdf

RuleException:
CalledProcessError in line 863 of /Users/katekistler/nextstrain/egg-passage/Snakefile:
Command 'set -euo pipefail;  python3 scripts/plot_titer_diffs.py             --in_file dataframes/h3n2_ha_12y_fra.csv' returned non-zero exit status 1.
  File "/Users/katekistler/nextstrain/egg-passage/Snakefile", line 863, in __rule_plot_titer_diffs
  File "/anaconda2/envs/py3/lib/python3.6/concurrent/futures/thread.py", line 56, in run
Shutting down, this might take some time.
Exiting because a job execution failed. Look above for error message
Complete log: /Users/katekistler/nextstrain/egg-passage/.snakemake/log/2019-04-23T220918.965830.snakemake.log
